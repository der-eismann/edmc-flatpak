app-id: io.edcd.EDMarketConnector
runtime: org.freedesktop.Platform
runtime-version: '22.08'
command: edmc
sdk: org.freedesktop.Sdk
finish-args:
  - --socket=x11
  - --share=ipc
  - --device=dri
  - --share=network
  - --filesystem=~/.steam/steam/steamapps/compatdata/359320/pfx/drive_c/users/steamuser/Saved\ Games/Frontier\ Developments/Elite\ Dangerous
cleanup:
  - '/man'
  - '/include'
  - '/share/man'
  - '/lib/pkgconfig'
modules:
  - python3-requirements.yaml

  - python3-tkinter.yaml

  - name: edmc
    buildsystem: simple
    build-commands:
      - mkdir edmc
      - tar xzfv edmc.tar.gz --directory=edmc/ --strip-components=1
      - rm -rf edmc/tests edmc/img
      - install -dm755 ${FLATPAK_DEST}/edmc
      - install -dm755 ${FLATPAK_DEST}/bin
      - cp -r edmc/* ${FLATPAK_DEST}/edmc
      - install edmc.sh ${FLATPAK_DEST}/bin/edmc
      - install -t ${FLATPAK_DEST}/share/appdata/ -Dm644 io.edcd.EDMarketConnector.appdata.xml
      - install -t ${FLATPAK_DEST}/share/applications/ -Dm644 io.edcd.EDMarketConnector.desktop
      - install -Dm644 edmc/EDMarketConnector.png ${FLATPAK_DEST}/share/icons/hicolor/512x512/apps/${FLATPAK_ID}.png
    sources:
      - type: file
        url: https://github.com/EDCD/EDMarketConnector/archive/refs/tags/Release/5.6.1.tar.gz
        sha256: 637b14bf69105589abd49bd0d1044a5718eafd18daea856a3cdee44d9947a077
        dest-filename: edmc.tar.gz
      - type: file
        path: io.edcd.EDMarketConnector.desktop
      - type: file
        path: io.edcd.EDMarketConnector.appdata.xml
      - type: file
        path: edmc.sh
